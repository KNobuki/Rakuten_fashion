<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="author" content="Rakuten Fashion Dev Team">
<title>Rakuten Fashion</title>
<link href="images/favicon.png" rel="icon">
<link rel="stylesheet" href="CSS/bootstrap-slider.min.css">
<link href="http://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="plugins/slick/slick.css">
<link rel="stylesheet" type="text/css" href="plugins/slick/slick-theme.css">
<link rel="stylesheet" href="CSS/style.css">
<link rel="stylesheet" href="CSS/jquery-tagsinput.min.css">

<script type="text/javascript" src="plugins/bootstrap-slider.min.js"></script>
<script type="text/javascript" src="plugins/jquery/dist/jquery.min.js"></script>
<script type="text/javascript" src="plugins/jquery-ui/jquery-ui.min.js"></script>
<script type="text/javascript" src="plugins/slick/slick.min.js"></script>
<script src="https://code.jquery.com/color/jquery.color.plus-names-2.1.2.min.js"></script>
<script src="plugins/jquery-tagsinput.min.js"></script>


</head>

<body>
	<div class="header">
		<span style="font-size:20px; cursor:pointer" onclick="openNav()">&#9776; </span>
		<span id="logo">Rakuten Fashion</span>
		<div class="siderbar-search-box" id="searchTop">
			<form class="sidebar-search-box" id ="getForm">
                <input class="form-control" type="text" data-role='tags-input'/>
                <!-- <button class="btn btn-default">search<button/> -->
        </form>
		</div>
	</div>

	<div id="sideNav" class="sidenav">
	  	<a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
	  	<label><input name="Fruit" type="checkbox" value="" />A </label><br> 
	  	<label><input name="Fruit" type="checkbox" value="" />B </label><br> 
		<label><input name="Fruit" type="checkbox" value="" />C </label><br>
		<label><input name="Fruit" type="checkbox" value="" />D </label><br>
        <br>
        <div class="form-group form-group-sm">
            <label class="col-sm-2 control-label" for="formGroupInputSmall">label</label>
            <div class="col-sm-10">
                <select class="form-control">
                  <option>1</option>
                  <option>2</option>
                  <option>3</option>
                  <option>4</option>
                  <option>5</option>
                </select>
            </div>
        </div>
        <br>
        <br>
        <div class="form-group form-group-sm">
            <label class="col-sm-2 control-label" for="formGroupInputSmall">label</label>
            <div class="col-sm-10">
                <select class="form-control">
                  <option>1</option>
                  <option>2</option>
                  <option>3</option>
                  <option>4</option>
                  <option>5</option>
                </select>
            </div>
        </div>
        <br>
        <br>
        <br>
        <div style="text-align:center"><input id="priceRange" type="text"/></div>    
        <br>
        <br>
		<button class="btn btn-default center-block " onclick="sideBarSearch()">Search</button>
	</div>

	<!-- <div class="siderbar-search-box">
			<input class="form-control" type="text" placeholder="Search Productâ€¦">
		  	<button>Search</button>
	</div> -->

	<div id= "searchList">
	</div>
	<div class="footer">
		<h1>
			Rakuten Fashion
		</h1>
		<a target="_blank" href="https://brandavenue.rakuten.co.jp/">Rakuten BrandAvenue</a>
	</div>
	
</body>

</html>

<script>
    new Slider("#priceRange", { min: 0, max: 1000, value: [0, 1000], focus: true });

    $(document).ready(function() {
        $('[data-role="tags-input"]').tagsInput();
    });

    function openNav() {
        document.getElementById("sideNav").style.width = "250px";
    }

    function closeNav() {
        document.getElementById("sideNav").style.width = "0";
    }

    function sideBarSearch(jsonObj) {

    }


     function indexSearch(jsonObj) {
        var searchList = document.getElementById("searchList");
        let itemNumber = 10;
        searchList.setAttribute("style", "height : " + Math.ceil(itemNumber / 4) * 400 + "px;");
        for(let i = 0; i < itemNumber; i ++) {
            let productBox = document.createElement("div");
            productBox.setAttribute("class", "productbox");
            let productImages = document.createElement("div");
            productImages.setAttribute("class","productImages");
            productImages.setAttribute("id","productImages_" + i);
            for(let j = 0; j < jsonObj[i].image.length; j ++) {
                let productImage = document.createElement("img");
                productImage.setAttribute("class","productImage");
                productImage.setAttribute("src",jsonObj[i].image[j].imageUrl);
                productImages.appendChild(productImage);
            }
            let productName = document.createElement("p");
            productName.setAttribute("class", "productName");
            productName.innerHTML = "slipper";
            let productPrice = document.createElement("p");
            productPrice.setAttribute("class", "productPrice");
            productPrice.innerHTML = jsonObj[i].price;
            let variants = document.createElement("div");
            variants.setAttribute("class","variants");
            variants.setAttribute("id", "variants_" + i);
            for(let k = 0; k < jsonObj[i].image.length; k ++) {
                let variant = document.createElement("img");
                variant.setAttribute("class","variant");
                variant.setAttribute("src",jsonObj[i].image[k].imageUrl);
                variants.appendChild(variant);
            }
            let id = document.createElement("input");
            id.setAttribute("type", "hidden");
            id.setAttribute("id", "itemId");
            id.setAttribute("value", jsonObj[i].id);
            let a = document.createElement("a");
            // a.setAttribute("href", "itemDetail.html");
            a.setAttribute("onclick", "OnLinkClick(this)");
            a.appendChild(id);
            a.appendChild(productImages);
            productBox.appendChild(a);
            productBox.appendChild(variants);
            productBox.appendChild(productName);
            productBox.appendChild(productPrice);
            searchList.appendChild(productBox);

            $('#variants_' + i).slick({
			  infinite: true,
			  slidesToShow: jsonObj[i].image.length,
			  slidesToScroll: jsonObj[i].image.length,
			  infinite: true,
			  speed: 300,
			  arrows: true,
			  centerMode: true,
			  variableWidth: true,
  			  asNavFor: "#productImages_" + i,
  			  focusOnSelect: true
			});

         $("#productImages_" + i).slick({
			  slidesToShow: 1,
			  slidesToScroll: 1,
			  arrows: false,
			  fade: true,
			  asNavFor: '#variants_' + i
			});
        }      
}
</script>

<script>
    var LocString=decodeURIComponent(String(window.document.location.href));
    let keyWord = LocString.split("=");
    let word = keyWord[1].split(";");
    let xhr = new XMLHttpRequest();
    xhr.open("GET","../rakuten_back 4.0/json_output.php?keyWord="+word[0], true);
    xhr.onload = function(){
        console.log(this.responseText);
        let searchListObj = JSON.parse(this.responseText);
        console.log(searchListObj);
        indexSearch(searchListObj);
    }
    xhr.send();

    function OnLinkClick(obj){
        let id = obj.value;
        let url = "itemDetail.html?id=" + id + ";";
        window.open(url);
    }

</script>
